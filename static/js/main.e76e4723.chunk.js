(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{283:function(e,t,n){e.exports=n(463)},463:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(73),c=n.n(o),l=(n(288),n(20)),i=n(21),u=n(23),s=n(22),d=n(24),m="kolmech-dev-token",p=n(238),f=n.n(p);function h(e){var t=function(e){var t=f()(e);if(!t.exp)return null;var n=new Date(0);return n.setUTCSeconds(t.exp),n}(e);return null!==t&&(console.log(t,(new Date).valueOf()+0),!(t.valueOf()>(new Date).valueOf()+0))}var b=n(28),v=n(15),g=n(31),E=n.n(g);function O(){var e=Object(v.a)(["\n\tmutation Login($email: String!, $password: String!) {\n\t\tlogin(email: $email, password: $password) {\n\t\t\ttoken\n\t\t}\n\t}\n"]);return O=function(){return e},e}function j(){var e=Object(v.a)(["\n\tquery MeLocal {\n\t\tme @client {\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t}\n\t\t}\n\t}\n"]);return j=function(){return e},e}function y(){var e=Object(v.a)(["\n\tquery Me {\n\t\tme {\n\t\t\tid\n\t\t\temail\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t}\n\t\t}\n\t}\n"]);return y=function(){return e},e}var k=E()(y()),C=(E()(j()),E()(O())),S=n(78),x=n.n(S),I=n(118),w=n(45),D=n(17),P=n(485),T=n(487),q=n(477),z=n(482),A=n(483);function B(){var e=Object(v.a)(["\n\tmax-width: 350px !important;\n\tmargin: auto !important;\n"]);return B=function(){return e},e}function M(){var e=Object(v.a)(["\n\tdisplay: inline;\n\tpadding: 0 1rem !important;\n"]);return M=function(){return e},e}function N(){var e=Object(v.a)(["\n\tborder-bottom: 1px solid #7e7e81;\n\t// height: 35px;\n"]);return N=function(){return e},e}var R=D.a.div(N()),$=Object(D.a)(P.a)(M()),Q=Object(D.a)(T.a)(B()),L=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",sendingRequest:!1,error:""},n.handleInputChange=function(e){n.setState(Object(w.a)({},e,n[e].value))},n.submit=Object(I.a)(x.a.mark(function e(){var t,a,r,o,c;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.state,a=t.email,r=t.password,n.setState({sendingRequest:!0}),e.next=5,n.props.login({variables:{email:a,password:r}});case 5:o=e.sent,c=o.data.login.token,n.setState({sendingRequest:!1}),n.props.refreshToken(c),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),n.setState({error:e.t0.message,sendingRequest:!1});case 14:case"end":return e.stop()}},e,this,[[0,11]])})),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.email,o=t.password,c=t.sendingRequest,l=t.error;return r.a.createElement(a.Fragment,null,r.a.createElement(R,null,r.a.createElement($,{size:"large"},r.a.createElement("i",null,"\u041f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044f \u043d\u0430 \u0443\u0447\u0430\u0441\u0442\u043a\u0430\u0445"))),r.a.createElement(Q,{basic:!0},r.a.createElement(q.a,{error:!!l},r.a.createElement(q.a.Field,null,r.a.createElement("label",null,"E-mail"),r.a.createElement("input",{type:"email",placeholder:"E-mail",ref:function(t){return e.email=t},onChange:function(){return e.handleInputChange("email")}})),r.a.createElement(q.a.Field,null,r.a.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",ref:function(t){return e.password=t},onChange:function(){return e.handleInputChange("password")}})),r.a.createElement(z.a,{error:!0,header:"\u0412\u043e\u0439\u0442\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:l}),r.a.createElement(A.a,{primary:!0,type:"submit",floated:"right",disabled:!n||!o||c,loading:c,onClick:this.submit},"\u0412\u043e\u0439\u0442\u0438"))))}}]),t}(a.Component),F=Object(b.compose)(Object(b.graphql)(C,{name:"login",options:{fetchPolicy:"no-cache"}}))(L),W=n(44),G=n(26),H=n.n(G);function J(){var e=Object(v.a)(["\n  fragment myDept on Dept {\n    id\n    name\n    type\n    prods {\n      id\n      melt\n      meltShift\n      number\n      year\n      isSpoiled\n      hasDefect\n      progress\n      htmlNote\n      model {\n        id\n        name\n        article\n      }\n    }\n  }\n"]);return J=function(){return e},e}function U(){var e=Object(v.a)(["\n  query AllDepts {\n    depts {\n      id\n      name\n      type\n      prods {\n        id\n        melt\n        meltShift\n        number\n        year\n        isSpoiled\n        hasDefect\n        progress\n        htmlNote\n        model {\n          id\n          name\n          article\n        }\n      }\n    }\n  }\n"]);return U=function(){return e},e}var X=E()(U()),Y=E()(J());function _(){var e=Object(v.a)(["\n  mutation moveProds ( $to: ID!, $prodIds: [ID!]! ) {\n    moveProds (\n      to: $to,\n      prodIds: $prodIds\n    ) {\n      prods {\n        id\n        dept {\n          id\n        }\n      }\n      to\n    }\n  }\n"]);return _=function(){return e},e}function K(){var e=Object(v.a)(["\n  mutation UpsertProd ($input: ProdInput!) {\n    upsertProd(input: $input) {\n      id\n      melt\n      meltShift\n      number\n      year\n      isSpoiled\n      hasDefect\n      progress\n      htmlNote\n      model {\n        id\n        name\n        article\n      }\n      dept {\n        id\n      }\n    }\n  }\n"]);return K=function(){return e},e}var Z=E()(K()),V=E()(_()),ee=n(476),te=n(484),ne=n(152),ae=n(479),re=n(68),oe=n(478);function ce(){var e=Object(v.a)(["\n  query allDeptsAndModelsQuery {\n    depts {\n      id\n      name\n    }\n    models {\n      id\n      name\n    }\n  }\n"]);return ce=function(){return e},e}var le=E()(ce()),ie=function(e){function t(e){var n;if(Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).open=function(){return n.setState({open:!0})},n.close=function(){return n.setState({open:!1})},n.handleSelChange=function(e,t){var a,r=t.name,o=t.value,c=t.required,l=!(""!==o||!c);n.setState((a={},Object(w.a)(a,r,o),Object(w.a)(a,"".concat(r,"Err"),l),a)),console.log("Selected: ".concat(o))},n.handleIntChange=function(e,t){var a,r=t.name,o=t.value,c=t.min,l=t.max,i=t.required,u=parseInt(o,10)||(0===parseInt(o,10)?0:""),s=!(""===u&&!i)&&(u<c||l<u);n.setState((a={},Object(w.a)(a,r,u),Object(w.a)(a,"".concat(r,"Err"),s),a))},n.changeStatus=function(e,t){var a=t.name;e.preventDefault(),e.stopPropagation();var r=n.state[a];n.setState({hasDefect:!1,isSpoiled:!1}),r||n.setState(Object(w.a)({},a,!0))},n.confirm=function(){var e=n.props.mode,t="create"===e?["deptId","modelId","melt","number","year"]:["melt","number","year"],a=!1;if(n.setState(Object.assign.apply(Object,Object(W.a)(t.map(function(e){return""===n.state[e]&&(a=!0,Object(w.a)({},"".concat(e,"Err"),!0))})))),t.forEach(function(e){n.state["".concat(e,"Err")]&&(a=!0)}),a)return null;var r=n.state,o=r.id,c=r.deptId,l=r.modelId,i=r.melt,u=r.number,s=r.year,d={deptId:c,modelId:l,melt:i,meltShift:n.state.meltShift||null,number:u,year:s,progress:n.state.progress||null,hasDefect:n.state.hasDefect||null,isSpoiled:n.state.isSpoiled||null};"create"===e?n.props.upsertProd({variables:{input:Object(re.a)({},d)}}):"edit"===e&&(d.id=o,n.props.upsertProd({variables:{input:Object(re.a)({},d)}})),n.close()},n.state={open:!1,deptId:"",modelId:"",melt:"",meltShift:"",number:"",year:"",progress:"",hasDefect:!1,isSpoiled:!1,deptIdErr:!1,modelIdErr:!1,meltErr:!1,meltShiftErr:!1,numberErr:!1,yearErr:!1,progressErr:!1},"edit"===e.mode)for(var a in n.state=Object(re.a)({},n.state,e.prod),n.state)null===n.state[a]&&(n.state[a]="");return n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=t.deptId,o=t.modelId,c=t.melt,l=t.meltShift,i=t.number,u=t.year,s=t.progress,d=t.hasDefect,m=t.isSpoiled,p=t.deptIdErr,f=t.modelIdErr,h=t.meltErr,b=t.meltShiftErr,v=t.numberErr,g=t.yearErr,E=t.progressErr,O=this.props,j=O.trigger,y=O.mode,k=[{text:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a ",value:""}],C=[{text:"\u0412\u0438\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438",value:""}];if("create"===y){var S=this.props.allDeptsAndModelsQuery;k=S?S.loading?[{text:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043f\u0438\u0441\u043a\u0430",value:""}]:S.error?[{text:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430",value:""}]:S.depts.map(function(e){return{text:e.name,value:e.id}}):[{text:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a ",value:""}],C=S?S.loading?[{text:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043f\u0438\u0441\u043a\u0430",value:""}]:S.error?[{text:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430",value:""}]:S.models.map(function(e){return{text:e.name,value:e.id}}):[{text:"\u0412\u0438\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438",value:""}]}return r.a.createElement(oe.a,{trigger:j,open:n,onOpen:this.open,onClose:this.close},r.a.createElement(oe.a.Header,{as:"h2"},"create"===y?"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"," \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044e "),r.a.createElement(oe.a.Content,null,r.a.createElement(q.a,{onSubmit:function(){return e.confirm()}},"create"===y&&r.a.createElement(q.a.Select,{label:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a",name:"deptId",options:k,onChange:this.handleSelChange,value:a,error:p,required:!0}),"create"===y&&r.a.createElement(q.a.Select,{label:"\u0412\u0438\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438",name:"modelId",options:C,onChange:this.handleSelChange,value:o,error:f,required:!0}),r.a.createElement(q.a.Group,{widths:"equal"},r.a.createElement(q.a.Input,{label:"\u041f\u043b\u0430\u0432\u043a\u0430",placeholder:"\u041f\u043b\u0430\u0432\u043a\u0430",required:!0,name:"melt",type:"number",min:"0",max:"999",error:h,onChange:this.handleIntChange,value:c}),r.a.createElement(q.a.Input,{label:"\u041f\u043b\u0430\u0432. \u0441\u043c\u0435\u043d\u0430 (\u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u043c\u0430\u0440\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u0430)",placeholder:"\u041f\u043b. \u0441\u043c\u0435\u043d\u0430",name:"meltShift",type:"number",min:"0",max:"3",error:b,onChange:this.handleIntChange,value:l}),r.a.createElement(q.a.Input,{label:"\u041d\u043e\u043c\u0435\u0440",placeholder:"\u041d\u043e\u043c\u0435\u0440",required:!0,name:"number",type:"number",min:"1",max:"999",error:v,onChange:this.handleIntChange,value:i}),r.a.createElement(q.a.Input,{label:"\u0413\u043e\u0434",placeholder:"\u0413\u043e\u0434",required:!0,name:"year",type:"number",min:"16",max:"18",error:g,onChange:this.handleIntChange,value:u})),r.a.createElement(q.a.Input,{label:"\u041f\u0440\u043e\u0446\u0435\u043d\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f",placeholder:"%",name:"progress",type:"number",min:"0",max:"100",error:E,onChange:this.handleIntChange,value:s}),r.a.createElement(q.a.Field,null,r.a.createElement("label",null,"\u041d\u0430\u043b\u0438\u0447\u0438\u0435 \u0434\u0435\u0444\u0435\u043a\u0442\u043e\u0432"),r.a.createElement(A.a.Group,null,r.a.createElement(A.a,{name:"hasDefect",active:d||null,color:d?"orange":null,onClick:this.changeStatus},"\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435"),r.a.createElement(A.a,{name:"isSpoiled",active:m||null,color:m?"red":null,onClick:this.changeStatus},"\u0411\u0440\u0430\u043a"))))),r.a.createElement(oe.a.Actions,null,r.a.createElement(A.a,{onClick:this.close,color:"red"},r.a.createElement(ne.a,{name:"remove"})," \u041e\u0442\u043c\u0435\u043d\u0430"),r.a.createElement(A.a,{onClick:this.confirm},r.a.createElement(ne.a,{name:"checkmark"})," ","create"===y?"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))}}]),t}(a.Component),ue=Object(b.compose)(Object(b.graphql)(le,{name:"allDeptsAndModelsQuery"}),Object(b.graphql)(Z,{name:"upsertProd",options:{update:function(e,t){var n=t.data.upsertProd,a="Dept:".concat(n.dept.id),r=Y,o=e.readFragment({id:a,fragment:r});delete n.dept,o.prods||(o.prods=[]),o.prods=Object(W.a)(o.prods.filter(function(e){return e.id!==n.id})).concat([n]),e.writeFragment({id:a,fragment:r,data:o})}}}))(ie);function se(){var e=Object(v.a)(["\n  query AllDeptsAndModelsQuery {\n    depts {\n      id\n      name\n    }\n  }\n"]);return se=function(){return e},e}var de=E()(se()),me=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,deptId:""},n.open=function(){return n.setState({open:!0})},n.close=function(){return n.setState({open:!1})},n.handleChange=function(e,t){t&&(n.setState({deptId:t.value}),console.log("Selected: ".concat(t.value)))},n.confirm=function(){var e=n.state.deptId;n.props.moveProds(e),n.close()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.open,n=e.deptId,a=this.props.trigger,o=this.props.AllDeptsAndModelsQuery,c=o?o.loading?[{text:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043f\u0438\u0441\u043a\u0430",value:""}]:o.error?[{text:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430",value:""}]:o.depts.map(function(e){return{text:e.name,value:e.id}}):[{text:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a ",value:""}];return r.a.createElement(oe.a,{trigger:a,open:t,onOpen:this.open,onClose:this.close},r.a.createElement(oe.a.Header,{as:"h2"}," \u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044e "),r.a.createElement(oe.a.Content,null,r.a.createElement(q.a,{onSubmit:this.confirm},r.a.createElement(q.a.Select,{label:"\u041a\u0443\u0434\u0430",options:c,onChange:this.handleChange,value:n,required:!0}))),r.a.createElement(oe.a.Actions,null,r.a.createElement(A.a,{onClick:this.close,color:"red"},r.a.createElement(ne.a,{name:"remove"})," \u041e\u0442\u043c\u0435\u043d\u0430"),r.a.createElement(A.a,{onClick:this.confirm},r.a.createElement(ne.a,{name:"arrow right"})," \u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))}}]),t}(a.Component),pe=Object(b.graphql)(de,{name:"AllDeptsAndModelsQuery"})(me),fe=[{type:"OWNED",title:"\u041d\u0430\u0448\u0438"},{type:"TRANSPORT",title:"\u0422\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442"},{type:"PARTNER",title:"\u041f\u043e\u0434\u0440\u044f\u0434\u0447\u0438\u043a\u0438"},{type:"CLIENT",title:"\u041a\u043b\u0438\u0435\u043d\u0442\u044b"}],he=function(e){var t=e.refreshToken,n=e.visibleDeptTypes,a=e.filterDeptType,o=e.moveProds;return r.a.createElement(te.a,{size:"huge",inverted:!0},r.a.createElement(te.a.Item,{header:!0},"KOMZ"),r.a.createElement(te.a.Menu,null,r.a.createElement(ue,{mode:"create",id:"",trigger:r.a.createElement(te.a.Item,{icon:!0,link:!0,name:"create",color:"grey"},r.a.createElement(ne.a,{name:"plus"}))}),r.a.createElement(pe,{moveProds:o,trigger:r.a.createElement(te.a.Item,{icon:!0,link:!0,name:"move",color:"grey"},r.a.createElement(ne.a,{name:"arrow right"}))})),r.a.createElement(te.a.Menu,{position:"right"},r.a.createElement(ae.a,{item:!0,icon:"setting",simple:!0,className:"komz-navBarSettingsItem"},r.a.createElement(ae.a.Menu,null,r.a.createElement(ae.a.Header,null,"\u0423\u0447\u0430\u0441\u0442\u043a\u0438"),fe.map(function(e){var t=e.type,o=e.title,c=H.a.includes(n,t);return r.a.createElement(ae.a.Item,{key:t,type:t,active:H.a.includes(n,t),onClick:function(e,t){return a(t.type)}},r.a.createElement(ne.a,{name:c?"checkmark box":"square outline"}),o)}))),r.a.createElement(te.a.Item,{icon:!0,onClick:function(){return t(null)}},r.a.createElement(ne.a,{name:"sign out"}))))},be=n(481),ve=n(237),ge=n(480),Ee=n(475),Oe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={checked:!1},n.handleClick=function(e,t){var a=n.state.checked,r=n.props.prod.id;n.setState({checked:!a}),n.props.selectProd(r)},n.preventPropagation=function(e,t){e.stopPropagation()},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.checked,t=this.props.prod,n=t.melt,a=t.meltShift,o=t.number,c=t.year,l=t.progress,i=t.isSpoiled,u=t.hasDefect;return r.a.createElement(ge.a.Item,{onClick:this.handleClick,active:e},r.a.createElement(ge.a.Content,null,r.a.createElement(ge.a.Content,{floated:"right"},r.a.createElement(ue,{mode:"edit",prod:this.props.prod,trigger:r.a.createElement(A.a,{size:"mini",content:"\u0420\u0435\u0434\u0430\u043a\u0442",icon:"edit",labelPosition:"right",onClick:this.preventPropagation})})),r.a.createElement(ge.a.Content,null,r.a.createElement(ge.a.Icon,{name:e?"checkmark box":"square outline"}),n,a>0&&"."+a,"-",o,"-",c,l&&r.a.createElement(ve.a,{size:"small"},l||"_","%"),u&&r.a.createElement(ve.a,{color:"orange",tag:!0,size:"small"},"\u041e\u0422\u041a\u041b\u041e\u041d\u0415\u041d\u0418\u0415"),i&&r.a.createElement(ve.a,{color:"red",tag:!0,size:"small"},"\u0411\u0420\u0410\u041a"))),l&&r.a.createElement(Ee.a,{percent:l,indicating:!0,autoSuccess:!0,attached:"bottom"}))}}]),t}(a.Component),je=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.prods;return r.a.createElement(ge.a,{divided:!0,selection:!0,size:"medium"},t.map(function(t){return r.a.createElement(Oe,{prod:t,key:t.id,selectProd:e.props.selectProd})}))}}]),t}(a.Component);function ye(){var e=Object(v.a)(["\n  &&&& {\n    padding-top: 0;\n  }\n"]);return ye=function(){return e},e}function ke(){var e=Object(v.a)(["\n  &&&& {\n    margin-top: 0;\n    padding-top: 0;\n    ","\n  }\n"]);return ke=function(){return e},e}var Ce=Object(D.a)(be.a.Title)(ke(),function(e){return e.active&&"{\n      padding-bottom: 0;\n    }"}),Se=Object(D.a)(be.a.Content)(ye()),xe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={activeIndex:[]},n.handleClick=function(e,t){var a=t.index,r=n.state.activeIndex,o=H.a.includes(r,a)?H.a.without(r,a):Object(W.a)(r).concat([a]);n.setState({activeIndex:o})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state.activeIndex,n=this.props.deptModels.map(function(n,a){var o=n.prods,c=o.length,l=o.filter(function(e){return 100===e.progress}).length,i=o.filter(function(e){return e.hasDefect}).length,u=o.filter(function(e){return e.isSpoiled}).length,s=c-l-u,d=n.id,m=H.a.includes(t,d);return r.a.createElement("div",{key:d+"_deptModel"},r.a.createElement(Ce,{active:m,index:d,onClick:e.handleClick},r.a.createElement(ne.a,{name:"dropdown"}),r.a.createElement(P.a,{size:"small",as:"span"},n.model.name,r.a.createElement(ve.a,{color:"grey"},c,r.a.createElement(ve.a.Detail,null,"\u0448\u0442"))),r.a.createElement(ve.a.Group,{className:"komz-ml-21px"},l>0&&r.a.createElement(ve.a,{basic:!0},r.a.createElement(ne.a,{name:"checkmark",color:"green"}),l,r.a.createElement(ve.a.Detail,null,"\u0413\u041f")),s>0&&r.a.createElement(ve.a,{basic:!0},s,r.a.createElement(ve.a.Detail,null,"\u041d\u0417\u041f")),i>0&&r.a.createElement(ve.a,{basic:!0},r.a.createElement(ne.a,{name:"warning sign",color:"orange"}),i,r.a.createElement(ve.a.Detail,null,"\u041e\u0422\u041a\u041b\u041e\u041d")),u>0&&r.a.createElement(ve.a,{basic:!0},r.a.createElement(ne.a,{name:"broken chain",color:"red"}),u,r.a.createElement(ve.a.Detail,null,"\u0411\u0420\u0410\u041a")))),m&&r.a.createElement(Se,{active:!0},r.a.createElement(je,{prods:n.prods,selectProd:e.props.selectProd})))});return r.a.createElement(be.a,null,n)}}]),t}(a.Component),Ie=n(269),we=n(61),De=n(486);function Pe(){var e=Object(v.a)(["\n\t&&&&&& {\n\t\twidth: 350px;\n\t\t&:hover {\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\n\t\t}\n\t}\n"]);return Pe=function(){return e},e}function Te(){var e=Object(v.a)(["\n\t&&& {\n\t\t","\n\t}\n"]);return Te=function(){return e},e}function qe(){var e=Object(v.a)(["\n\t& {\n\t\twidth: 100%\n\t\tpadding: 1em 1em 1em 1em;\n\t\t","\n\t\t","\n\t\t","\n\t\t","\n\t\t","\n\t\t","\n\t\t","\n\t\t","\n\t}\n"]);return qe=function(){return e},e}function ze(){var e=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t&.compact {\n\t\t\tpadding: .5rem 1rem;\n\t\t}\n\t\t","\n\t\t","\n\t}\n"]);return ze=function(){return e},e}function Ae(){var e=Object(v.a)(["\n\ttransform: ",";\n"]);return Ae=function(){return e},e}function Be(){var e=Object(v.a)(["\n\twidth: "," !important;\n\tmargin-right: 0 !important;\n"]);return Be=function(){return e},e}function Me(){var e=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return Me=function(){return e},e}function Ne(){var e=Object(v.a)(["\n\tcursor: pointer;\n\t","\n"]);return Ne=function(){return e},e}function Re(){var e=Object(v.a)(["\n\t","\n"]);return Re=function(){return e},e}function $e(){var e=Object(v.a)(["\n\t","\n"]);return $e=function(){return e},e}function Qe(){var e=Object(v.a)(["\n\t","\n\t","\n"]);return Qe=function(){return e},e}var Le={widths:{formLabel:"122px",detailsPL:"55px"},colors:{green:"#016936",blue:"#0E6EB8"}},Fe=function(e){return Le.colors[e]||e},We=function(e){var t=e.theme,n=e.w,a=e.m,r=e.ml,o=e.pl,c=e.fs,l=e.fw,i=e.c,u=e.lh,s=e.ta,d=e.ws;return"\n\t\t".concat(n?"width: ".concat(t.widths[n]||n,";"):"","\n\t\t").concat(a?"margin: ".concat(a,";"):"","\n\t\t").concat(r?"margin-left: ".concat(r,";"):"","\n\t\t").concat(o?"padding-left: ".concat(o,";"):"","\n\t\t").concat(c?"font-size: ".concat(c,";"):"","\n\t\t").concat(l?"font-weight: ".concat(l,";"):"","\n\t\t").concat(i?"color: ".concat(i,";"):"","\n\t\t").concat(u?"line-height: ".concat(u,";"):"","\n\t\t").concat(s?"text-align: ".concat(s,";"):"","\n\t\t").concat(d?"word-spacing: ".concat(d,";"):"","\n\t")},Ge=(Object(D.a)(function(e){e.ml,e.inline;var t=Object(we.a)(e,["ml","inline"]);return r.a.createElement("div",t)})(Qe(),function(e){return e.inline&&"display: inline-block;"},function(e){return We(e)}),Object(D.a)(function(e){var t=Object(Ie.a)({},e);return r.a.createElement("p",t)})($e(),function(e){return We(e)}),Object(D.a)(function(e){e.ml;var t=Object(we.a)(e,["ml"]);return r.a.createElement("span",t)})(Re(),function(e){return We(e)})),He=(D.a.a(Ne(),function(e){return e.cancel&&"{\n\t\tpadding-left: 15px;\n\t\tcolor: rgba(0,0,0,.87);\n\t\t&:hover {\n\t\t\tcolor: #B03060;\n\t\t}\n\t}"}),Object(D.a)(function(e){e.inline,e.c;var t=Object(we.a)(e,["inline","c"]);return r.a.createElement(P.a,t)})(Me(),function(e){return We(e)},function(e){return e.inline&&"{\n\t\t\tmargin: 0;\n\t\t\tpadding: 0 1rem;\n\t\t}"})),Je=(D.a.label(Be(),function(e){return e.theme.widths.formLabel}),Object(D.a)(function(e){e.active;var t=e.size,n=Object(we.a)(e,["active","size"]);return r.a.createElement(ne.a,Object.assign({},n,{size:t,name:"dropdown"}))})(Ae(),function(e){return!e.active&&("large"===e.size?"translateX(0) translateY(0) rotate(-90deg) !important":"translateX(-3px) translateY(3px) rotate(-90deg) !important")})),Ue=(Object(D.a)(function(e){e.activeColor,e.menu;var t=Object(we.a)(e,["activeColor","menu"]);return r.a.createElement(A.a,t)})(ze(),function(e){return We(e)},function(e){return e.activeColor&&"{\n\t\t\t&:hover {\n\t\t\t\tcolor: ".concat(Fe(e.activeColor)," !important;\n\t\t\t}\n\t\t\t&.active {\n\t\t\t\tcolor: ").concat(Fe(e.activeColor)," !important;\n        \t}\n\t\t}")},function(e){return e.menu&&"{\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\n\t\t\tz-index: 3;\n\t\t}"}),Object(D.a)(function(e){e.head,e.minor,e.small,e.secondary,e.noIndent,e.topBorder,e.bottomBorder;var t=e.children,n=Object(we.a)(e,["head","minor","small","secondary","noIndent","topBorder","bottomBorder","children"]);return r.a.createElement("div",n,t)})(qe(),function(e){return e.head&&"{\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tpadding-top: 0;\n\t\t\tpadding-bottom: 0;\n\t\t}"},function(e){return e.onClick&&"{\n\t\t\tcursor: pointer;\n\t\t}"},function(e){return e.minor&&"{\n\t\t\tmin-height: 3.5em;\n\t\t}"},function(e){return e.small&&"{\n\t\t\tmin-height: 2.5em;\n\t\t}"},function(e){return e.secondary&&"{\n\t\t\tbackground: #f3f4f5;\n\t\t\tcolor: rgba(0,0,0,.6);\n\t\t}"},function(e){return e.noIndent&&"{\n\t\t\tpadding-left: 0;\n\t\t}"},function(e){return e.topBorder&&"{\n\t\t\tborder-top: 1px solid rgba(34,36,38,.15);\n\t\t}"},function(e){return e.bottomBorder&&"{\n\t\t\tborder-bottom: 1px solid rgba(34,36,38,.1);\n\t\t}"}));Object(D.a)(function(e){e.showIf;var t=Object(we.a)(e,["showIf"]);return r.a.createElement(De.a,t)})(Te(),function(e){return!e.showIf&&"{\n\t\t\topacity: 0;\n\t\t}"}),Object(D.a)(ae.a)(Pe());function Xe(){var e=Object(v.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(35px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return Xe=function(){return e},e}function Ye(){var e=Object(v.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(35px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return Ye=function(){return e},e}var _e=Object(D.a)(ne.a)(Ye()),Ke=Object(D.a)(Je)(Xe()),Ze=function(e){var t=e.closeDetails,n=e.expanded,a=e.onClick,o=e.children,c=t?"main":"expandable";return r.a.createElement(Ue,{head:!0,noIndent:!0,bottomBorder:!0,minor:!0,onClick:a},"main"===c?r.a.createElement(_e,{link:!0,size:"big",name:"cancel",onClick:t}):r.a.createElement(Ke,{size:"large",active:n?1:0}),o)},Ve=function(e){var t=e.text;return r.a.createElement(Ge,{ml:"10px",fs:"1rem",c:"rgba(0,0,0,.6)",ws:"0.5em"},t)},et=function(e){var t=e.title,n=e.subtitle,a=e.titleSize;return r.a.createElement(He,{m:"0",size:a||"medium"},t,n&&r.a.createElement(Ve,{text:n}))},tt=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.expanded,n=e.title,a=e.subtitle,o=e.titleSize,c=e.onClick;return r.a.createElement(Ze,{expanded:t,onClick:c},r.a.createElement(et,{title:n,subtitle:a,titleSize:o}))}}]),t}(a.Component);function nt(){var e=Object(v.a)(["\n  &&&& { \n    padding-top: 0;\n  }\n"]);return nt=function(){return e},e}function at(){var e=Object(v.a)(["\n  &&&& { \n    padding: 0;\n    ","\n  }\n"]);return at=function(){return e},e}var rt=Object(D.a)(Ue)(at(),function(e){return e.expanded&&"{\n      margin-top: -1px;\n      border-bottom-color: rgba(34, 36, 38, 0.15);\n    }"}),ot=Object(D.a)(Ue)(nt()),ct=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={expanded:!1},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state.expanded,n=this.props,a=n.title,o=n.subtitle,c=n.children,l=n.size;return r.a.createElement(rt,{expanded:t?1:0,topBorder:t,bottomBorder:t},r.a.createElement(tt,{expanded:t,title:a,subtitle:o,titleSize:l||"small",onClick:function(){return e.setState({expanded:!t})}}),t&&r.a.createElement(ot,null,c))}}]),t}(a.Component);function lt(){var e=Object(v.a)(["\n  &&&& {\n    padding: 0;\n  }\n"]);return lt=function(){return e},e}var it=Object(D.a)(T.a)(lt()),ut=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.depts,n=H.a.cloneDeep(t).map(function(e){return Object(re.a)({},e,{prodsCount:e.prods.length,deptModels:H()(e.prods).sortBy("model.name").groupBy("model.id").reduce(function(e,t){return e.push({id:t[0].model.id,model:Object(re.a)({},t[0].model),prods:H.a.sortBy(t.map(function(e){return delete e.model,e}),function(e){return-(e.progress||!e.progress)})}),e},[]),prods:"cleared"})});return r.a.createElement(be.a,{fluid:!0},n.map(function(t,n){return r.a.createElement(it,{key:t.id,color:"TRANSPORT"===t.type?"green":"PARTNER"===t.type?"blue":"CLIENT"===t.type?"purple":"black"},r.a.createElement(ct,{size:"large",title:t.name,subtitle:"(".concat(t.prodsCount,")")},r.a.createElement(xe,{deptModels:t.deptModels,selectProd:e.props.selectProd})))}))}}]),t}(a.Component),st=function(e){return r.a.createElement(z.a,{warning:!0},r.a.createElement("p",null,r.a.createElement(ne.a,{name:"warning"}),r.a.createElement("b",null,"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 ",e.dataTitle)),r.a.createElement("p",null,r.a.createElement("u",null,"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435:")),r.a.createElement("p",null,"1. \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"),r.a.createElement("p",null,"2. \u0417\u0430\u043d\u043e\u0432\u043e \u0432\u043e\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443"),r.a.createElement("p",null,"3. \u0415\u0441\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f, \u0441\u043e\u043e\u0431\u0449\u0438\u0442\u0435 \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0443"),r.a.createElement("p",null,"4. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u044b \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430"))},dt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={selectedProds:[],visibleDeptTypes:["OWNED","TRANSPORT"]},n.selectProd=function(e){var t=n.state.selectedProds,a=H.a.includes(t,e)?H.a.without(t,e):Object(W.a)(t).concat([e]);n.setState({selectedProds:a})},n.filterDeptType=function(e){console.log("type > ",e);var t=n.state.visibleDeptTypes,a=H.a.includes(t,e)?H.a.without(t,e):Object(W.a)(t).concat([e]);n.setState({visibleDeptTypes:a})},n.moveProds=function(){var e=Object(I.a)(x.a.mark(function e(t){var a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.selectedProds,e.prev=1,e.next=4,n.props.moveProds({variables:{to:t,prodIds:a}});case 4:a.forEach(function(e){return n.selectProd(e)}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.visibleDeptTypes,t=this.props,n=t.refreshToken,a=t.allDepts,o=a.loading,c=a.error,l=a.depts;return r.a.createElement(ee.a,{text:!0},r.a.createElement(he,{refreshToken:n,visibleDeptTypes:e,filterDeptType:this.filterDeptType,moveProds:this.moveProds}),o?r.a.createElement("div",null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"):c?r.a.createElement(st,{dataTitle:"DeptList"}):r.a.createElement(ut,{depts:l.filter(function(t){return!!H.a.includes(e,t.type)}),selectProd:this.selectProd}))}}]),t}(a.Component),mt=Object(b.compose)(Object(b.graphql)(X,{name:"allDepts"}),Object(b.graphql)(V,{name:"moveProds",options:{update:function(e,t){var n=t.data.moveProds,a=n.prods,r=n.to,o=X,c=e.readQuery({query:o}),l=H()(a).groupBy("dept.id").reduce(function(e,t,n){var a=c.depts.find(function(e){return e.id===n}),r=H.a.intersectionBy(a.prods,t,"id");return a.prods=H.a.differenceBy(a.prods,t,"id"),Object(W.a)(e).concat(Object(W.a)(r))},[]);console.log("allMovedProds > ",l);var i=c.depts.find(function(e){return e.id===r});i.prods=Object(W.a)(i.prods).concat(Object(W.a)(l)),e.writeQuery({query:o,data:c})}}}))(dt),pt=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={token:n.props.token},n.bootStrapData=function(){try{var e=localStorage.getItem(m);if(null!==e&&void 0!==e)h(e)?n.refreshToken(null):n.setState({token:e})}catch(t){console.log("")}},n.refreshToken=function(e){e?localStorage.setItem(m,e):(localStorage.removeItem(m),n.props.client.resetStore()),n.setState({token:e})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.bootStrapData()}},{key:"render",value:function(){var e=this,t=this.state.token;return r.a.createElement(a.Fragment,null,t?r.a.createElement(b.Query,{query:k},function(t){var n=t.loading,a=t.error,o=t.data;return n?null:a?"Error!: ".concat(a.message):r.a.createElement(mt,{me:o.me,refreshToken:e.refreshToken})}):r.a.createElement(F,{refreshToken:this.refreshToken}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ft=new(n(273).a)({uri:"https://env-1542080.mircloud.ru",request:function(e){var t=localStorage.getItem(m);e.setContext({headers:{Authorization:t?"Bearer ".concat(t):""}})}}),ht=localStorage.getItem(m);c.a.render(r.a.createElement(b.ApolloProvider,{client:ft},r.a.createElement(pt,{token:ht,client:ft})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[283,2,1]]]);
//# sourceMappingURL=main.e76e4723.chunk.js.map